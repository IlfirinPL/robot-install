$Env:PY_PYTHON=2
Set-ExecutionPolicy Bypass -Scope Process -Force;

$login = Read-Host "Enter CK (user login)"
$password = Read-Host "Enter password for CK $login" -AsSecureString
$password = [Runtime.InteropServices.Marshal]::SecureStringToBSTR($password)
$password = [Runtime.InteropServices.Marshal]::PtrToStringAuto($password)
$email = Read-Host "Provided Company Email"

# Set directory for installation - Chocolatey does not lock
# down the directory if not the default
$InstallDir='C:\ProgramData\chocoportable'
$env:ChocolateyInstall="$InstallDir"

# If your PowerShell Execution policy is restrictive, you may
# not be able to get around that. Try setting your session to
# Bypass.

# All install options - offline, proxy, etc at
# https://chocolatey.org/install
iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
choco feature enable -n=allowGlobalConfirmation
choco --version

choco install git 
choco install putty
$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")

Write-Output "####### Setup Git start"
git config --global http.proxy ${login}:${password}@spplapp10200:8080
git config --global user.email "${email}"
New-Item -itemtype directory $env:APPDATA/pip -Force 
New-Item -Path $env:APPDATA/pip -Name "pip.ini" -ItemType "file" -Force -Value "[global]`nindex-url = https://artifactory.inspol.biz/api/pypi/pypi/simple`n`nfind-links = https://artifactory.inspol.biz/api/pypi/pypi/simple`n`ntrusted-host = artifactory.inspol.biz`n               pypi.python.org`n               pypi.org`n               files.pythonhosted.org`n`n[install]`nfind-links = https://artifactory.inspol.biz/api/pypi/pypi/simple"

$Env:PY_PYTHON=2
python -m pip install -U pip wheel pywin32 setuptools
python -m pip install -U -r https://raw.githubusercontent.com/IlfirinPL/robot-install/master/packages-2.7-legacy.txt
robot --version
